<!DOCTYPE html>

<!--
<html xmlns:th="https://www.thymeleaf.org" th:replace="~{fragments/layout :: layout (~{::body},'home')}">
--> 
<html>
  <head>
    <script src="https://pixijs.download/release/pixi.js"></script>
  </head>

  <body>

    <h1>PixiJS Test</h1>
    
	<script>
	  let width = 640;
	  let height = 480;
	
	  // pixijs application frame setup
	  const app = new PIXI.Application({
		  width: width,
		  height: height,
		  background: '#c0c0c0',
	  });
	  document.body.appendChild(app.view);
	  
	  
	  // background on which we listen for mouse events
	  const background = PIXI.Sprite.from('resources/images/pixel_7092bf.png'); // asynchronous load
	  background.width = width;
	  background.height = height;
	  app.stage.addChild(background);
	  
	  // note: see https://github.com/pixijs/pixijs/issues/4856 for using dots to build paths
	  const dot = PIXI.Sprite.from('resources/images/dot_black_7x7.png');
	  dot.anchor.set(0.5);
	  dot2 = PIXI.Sprite.from(dot.texture);
	  
	  // for drawing:
	  let isDrawing = false;
	  // EventEmitter event scheme (https://github.com/primus/eventemitter3)
      background.eventMode = 'static';
      background.on('mousedown', (event) => { isDrawing = true; console.log('mousedown evt');});
      background.on('mouseup', (event) => { isDrawing = false; console.log('mouseup evt'); });
      background.on('mouseupoutside', (event) => { isDrawing = false; console.log('mouseupoutside evt'); });
      background.on('mousemove', (event) => { 
    	  console.log('mousemove, isDrawing = ' + isDrawing)
    	  if (isDrawing) {
    		  // todo: skip new sprite if we're too close to last one from this same drawing stint
    		  let newdot = PIXI.Sprite.from(dot.texture);
  		      newdot.anchor.set(0.5);
  		      newdot.x = event.x;
  		      newdot.y = event.y;
  		      app.stage.addChild(newdot);
    	  }
      });

      // todo: switch to 
      
	</script>

  </body>

</html>